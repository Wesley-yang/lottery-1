webpackJsonp([1],{100:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(3),s=a(59),o=a.n(s),i=a(57),r=a.n(i),l=a(60),u=(a.n(l),a(58));n.default.prototype.$http=r.a,n.default.use(o.a),n.default.config.productionTip=!1,new n.default({el:"#app",router:u.a,template:"\n\t\t<router-view></router-view>\n\t",data:function(){return{host:""}},created:function(){-1!==location.href.indexOf("localhost")&&(this.host="http://localhost/annual_lottery/")},components:{}})},101:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(103),s=a.n(n),o=a(157),i=a.n(o);e.default={name:"admin",data:function(){return{people:[],activeNames:["2"],rate:"",willChange:[]}},created:function(){"UTWNAtvrro0CTK1gQgGwPtT9gPWKhpzcsPkql4bspo0wNxrCu2WOx6UU97ZzILDFNfTKJ0VG8Edsi3Zj"!==this.$route.query.password&&this.$router.replace({path:"/"})},mounted:function(){this.allPeople(),document.getElementsByTagName("body")[0].style.background="none",document.getElementsByTagName("html")[0].style.background="none"},methods:{allPeople:function(){var t=this;console.log(this.$root.host),this.$http.get(this.$root.host+"front/do-annual.php?action=queryPeople").then(function(e){t.people=e.data})},filterDepartment:function(t,e){return e.department===t},filterWinner:function(t,e){return Number(e.winner)===Number(t)},clearWinner:function(){var t=this;this.$confirm("此操作不可逆，请确认已记住所有中奖者","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.get(t.$root.host+"front/do-annual.php?action=clearWinner").then(function(e){"ok"===e.data.status&&(t.$message({type:"success",message:"清空中奖者成功!"}),t.allPeople())})}).catch(function(){t.$message({type:"info",message:"已取消该操作"})})},clearRate:function(){var t=this;this.$confirm("此操作不可逆，请确认：所有人的中奖概率将设置为100%","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.get(t.$root.host+"front/do-annual.php?action=clearRate").then(function(e){"ok"===e.data.status&&(t.$message({type:"success",message:"初始化中奖概率成功!"}),t.allPeople())})}).catch(function(){t.$message({type:"info",message:"已取消该操作"})})},selectLine:function(t){this.willChange=t},setRate:function(){var t=this,e={};e.rate=Number(this.rate).toFixed(2);var a=0;e.users=[];var n=!0,o=!1,r=void 0;try{for(var l,u=s()(this.willChange);!(n=(l=u.next()).done);n=!0){var c=l.value;e.users[a]={},e.users[a].id=c.id,e.users[a].name=c.name,a++}}catch(t){o=!0,r=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw r}}if(e=i.a.stringify(e),0===this.willChange.length)return void this.$message({type:"info",message:"请在列表中选择要修改参与者"});if(""===this.rate||isNaN(this.rate)||Number(this.rate)>1)return void this.$message({type:"info",message:"请填写正确的中奖概率"});var p="",v=!0,h=!1,m=void 0;try{for(var d,f=s()(this.willChange);!(v=(d=f.next()).done);v=!0){p+=" "+d.value.name}}catch(t){h=!0,m=t}finally{try{!v&&f.return&&f.return()}finally{if(h)throw m}}this.$confirm("将设置："+p+" ，以上"+this.willChange.length+"人的中奖概率为"+100*Number(this.rate)+"%","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post(t.$root.host+"front/do-annual.php?action=changeRate",e).then(function(e){"ok"===e.data.status&&(t.$message({type:"success",message:"设置成功!"}),t.allPeople())})}).catch(function(){t.$message({type:"info",message:"已取消该操作"})})}}}},102:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"app",data:function(){return{status:"waiting",amount:10,people:[],winner:[],rolling:[],interval:""}},mounted:function(){this.allPeople()},methods:{allPeople:function(){var t=this;this.$http.get(this.$root.host+"front/do-annual.php?action=queryPeople").then(function(e){t.people=e.data})},start:function(){var t=this;this.status="rolling";var e=new URLSearchParams;e.append("amount",this.amount),this.interval=setInterval(function(){t.rolling=[];for(var e=[],a=0;a<t.amount;a++){var n=Math.round(Math.random()*(t.people.length-1));e.push(t.people[n].name)}t.rolling=e},100),this.winner=[{name:"等待ing..."}],this.$http.post(this.$root.host+"front/do-annual.php?action=lottery",e).then(function(e){t.winner=e.data})},stop:function(){this.rolling=[],this.status="result",clearInterval(this.interval)},restart:function(){this.status="waiting"}}}},151:function(t,e){},152:function(t,e){},153:function(t,e){},160:function(t,e,a){a(151);var n=a(55)(a(101),a(162),null,null);t.exports=n.exports},161:function(t,e,a){a(152),a(153);var n=a(55)(a(102),a(163),"data-v-5ebd7dd6",null);t.exports=n.exports},162:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"panel"},[a("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"初始化操作",name:"1"}},[a("el-button",{attrs:{type:"danger",size:"large"},on:{click:t.clearWinner}},[t._v("清空中奖者")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"large"},on:{click:t.clearRate}},[t._v("初始化中奖概率")])],1),t._v(" "),a("el-collapse-item",{attrs:{title:"修改中奖概率",name:"2"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"请输入中奖概率，用小数表示，最多精确到小数点后两位"},model:{value:t.rate,callback:function(e){t.rate=e},expression:"rate"}})],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:t.setRate}},[t._v("修改")])],1)],1),t._v(" "),a("div",[t._v("请先选择需要修改的用户，再修改中奖概率")])],1),t._v(" "),a("el-collapse-item",{attrs:{title:"快捷操作按钮",name:"2"}},[a("el-button",{attrs:{size:"large"},on:{click:t.allPeople}},[t._v("刷新")]),t._v(" "),a("div",[t._v("刷新会重绘表格")])],1)],1)],1),t._v(" "),a("div",{staticClass:"data-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.people,border:"",stripe:"","tooltip-effect":"dark"},on:{"selection-change":t.selectLine}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"department",label:"所属中心",filters:[{text:"总经办",value:"总经办"},{text:"商业策略中心",value:"商业策略中心"},{text:"石油零售中心",value:"石油零售中心"},{text:"企业研发中心",value:"企业研发中心"},{text:"用户研发中心",value:"用户研发中心"},{text:"市场运营中心",value:"市场运营中心"},{text:"财务",value:"财务"},{text:"人事行政部",value:"人事行政部"}],"filter-method":t.filterDepartment,"show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"winner",label:"是否中奖",filters:[{text:"否",value:"0"},{text:"已中奖",value:"1"}],"filter-method":t.filterWinner},scopedSlots:t._u([["default",function(e){return[t._v(t._s(1===Number(e.row.winner)?"已中奖":"否"))]}]])}),t._v(" "),a("el-table-column",{attrs:{prop:"rate",label:"中奖概率",sortable:""},scopedSlots:t._u([["default",function(e){return[t._v(t._s(100*Number(e.row.rate.toFixed(2)))+"%")]}]])})],1)],1)])},staticRenderFns:[]}},163:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("div",{staticClass:"box"},[a("img",{staticClass:"background",attrs:{src:"https://martin-upload.b0.upaiyun.com/web/2017/04/12848feeaea4cec339963559db0866d3.jpg",alt:""}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"waiting"===t.status,expression:"status === 'waiting'"}],staticClass:"number"},[t._v("\n                抽\n                "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],attrs:{type:"tel"},domProps:{value:t.amount},on:{input:function(e){e.target.composing||(t.amount=e.target.value)}}}),t._v("\n                人\n            ")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"rolling"===t.status,expression:"status === 'rolling'"}],staticClass:"roll"},t._l(t.rolling,function(e){return a("div",{staticClass:"name"},[t._v(t._s(e))])})),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"waiting"===t.status,expression:"status === 'waiting'"}],staticClass:"begin",on:{click:function(e){t.start()}}},[t._v("开始")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"rolling"===t.status,expression:"status === 'rolling'"}],staticClass:"stop",on:{click:function(e){t.stop()}}},[t._v("停止")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"result"===t.status,expression:"status === 'result'"}],staticClass:"next",on:{click:function(e){t.restart()}}},[t._v("开启下轮抽奖")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"result"===t.status,expression:"status === 'result'"}],staticClass:"win-title"},[t._v("中奖名单")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"result"===t.status,expression:"status === 'result'"}],staticClass:"result"},t._l(t.winner,function(e){return a("div",{staticClass:"name"},[t._v(t._s(e.name))])}))])])},staticRenderFns:[]}},58:function(t,e,a){"use strict";var n=a(3),s=a(164),o=a(161),i=a.n(o),r=a(160),l=a.n(r);n.default.use(s.a),e.a=new s.a({routes:[{path:"/",name:"Lottery",component:i.a},{path:"/admin",name:"admin",component:l.a}]})},60:function(t,e){}},[100]);